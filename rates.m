function dydt = rates(t,b)
%b is concentration of species and t is time
% b = d[CH4]./dt , b1=[CH4]
% c = d[CH3]./dt , b2=[CH3]
% d = d[H]./dt , b3=[H]
% e = d[Na2]./dt , b4=[Na2]
% f = d[(Na)]./dt , b5=[(Na)]
% g = d[(Na)3]./dt , b6=[(Na)3]
% h = d[NaH]./dt , b7=[NaH]
% i = d[HNaCH3]./dt , b8=[HNaCH3]
% j = d[Na2H]./dt , b9=[Na2H]
% k = d[Na2CH3]./dt , b10=[Na2CH3]
% l = d[HNa2CH3]./dt , b11=[HNa2CH3]
% m = d[HNa3CH3]./dt , b12=[HNa3CH3]
% n = d[H2]./dt , b13=[H2]
% o = d[C2H6]./dt , b14=[C2H6]
% p = d[(Na)CH3]./dt , b15=[(Na)CH3]
% q = d[Na3H]./dt , b16=[Na3H]
dydt = zeros(16,1);
Pch4=0.45*101325;
Par=Pch4;
Pna=0.1*101325;
N=6.023E17; %conversion from molecules in 1 cm^3 to 1 m^3
V0=0.001; %m^3
N1=Pch4*V0/(8.314.*973); %mol P1V0./RT
N5=Pna*V0/(8.314*973); %mol P6V0./RT
Nar=Par*V0/(8.314*973); %mol ParV0./RT
N0=N1+N5+Nar;
Nt=b(1)+b(2)+b(3)+b(4)+b(5)+b(6)+b(7)+b(8)+b(9)+b(10)+b(11)+b(12)+b(13)+b(14)+b(15)+b(16)+Nar;
V=Nt*V0/N0;
V=V';
b=b';%N0RT0./V0 = NtRT0./V same pressure and T0 so V=V0*Nt./N0;

% kf=[1.1E-8, 2.2E9, 1.5E11, (na)*2.2E-21, (na)*3.2E-22, (na)*1E-23, (na)*9.4E-27, (na)*2.3E-23, (na)*3.1E-21, (na)*6.9E-13, (na)*9.9E-24, 9.5E9, 8.7E10, 6.8E3, 8.4E5, 7.1E3, 5E9, 5.8E8, 4.4E-1, 1.4E8, 2.4E1, 4.7E6, (na)*1.9E-10, (na)*2.8E-10];
% kb=[(na)*4.1E-10, (na)*1.5E-9, (na)*4.4E-9, (na)*1.9E-10, 4.1E9, (na)*1.9E-12, (na)*6.6E-11, 3.9E2, 4.7E4, (na)*5.7E-15, (na)*3.8E-19, (na)*3.3E-9, (na)*7.3E-9, (na)*3E-9, (na)*2.3E-10, (na)*1.4E-9, (na)*1.5E-9, (na)*3.1E-9, (na)*3.7E-12, (na)*5.1E-10, (na)*5E-10, (na)*3.9E-11, 1.8E-10, 2.7E-4];
kf=[1.1*10^-8 2.2*10^9 1.5*10^11 N*2.2*10^-21 N*3.2*10^-22 N*10^-23 N*9.4*10^-27 N*2.3*10^-23 N*3.1*10^-21 N*6.9*10^-13 N*9.9*10^-24 9.5*10^9 8.7*10^10 6.8*10^3 8.4*10^5 7.1*10^3 5*10^9 5.8*10^8 4.4*10^-1 1.4*10^8 2.4*10^1 4.7*10^6 N*1.9*10^-10 N*2.8*10^-10];

kb=[N*4.1*10^-10 N*1.5*10^-9  N*4.4*10^-9 N*1.9*10^-10 4.1*10^9 N*1.9*10^-12 N*6.6*10^-11 3.9*10^2 4.7*10^4 N*5.7*10^-15 N*3.8*10^-19 N*3.3*10^-9 N*7.3*10^-9 N*3*10^-9  N*2.3*10^-10 N*1.4*10^-9 N*1.5*10^-9 N*3.1*10^-9 N*3.7*10^-12 N*5.1*10^-10 N*5*10^-10 N*3.9*10^-11 1.8*10^-10 2.7*10^-4];

r1=-kf(1)*(b(1)./V)+kb(1)*(b(2)./V)*(b(3)./V);

r2=-kf(2)*(b(4)./V)+2*kb(2)*(b(5)./V)*(b(5)./V);

r3=-kf(3)*(b(6)./V)+kb(3)*(b(4)./V)*(b(5)./V);

r4=-kf(4)*(b(1)./V)*(b(5)./V)+kb(4)*(b(7)./V)*(b(2)./V);

r5=-kf(5)*(b(5)./V)*(b(1)./V)+kb(5)*(b(8)./V);

r6=-kf(6)*(b(1)./V)*(b(4)./V)+kb(6)*(b(9)./V)*(b(2)./V);

r7=-kf(7)*(b(1)./V)*(b(4)./V)+kb(7)*(b(10)./V)*(b(3)./V);

r8=-kf(8)*(b(1)./V)*(b(4)./V)+kb(8)*(b(11)./V);

r9=-kf(9)*(b(1)./V)*(b(6)./V)+kb(9)*(b(12)./V);

r10=-kf(10)*(b(1)./V)*(b(3)./V)+kb(10)*(b(2)./V)*(b(13)./V);

r11=-kf(11)*(b(1)./V)*(b(2)./V)+kb(11)*(b(14)./V)*(b(3)./V);

r12=-kf(12)*(b(8)./V)+kb(12)*(b(15)./V)*(b(3)./V);

r13=-kf(13)*(b(8)./V)+kb(13)*(b(7)./V)*(b(2)./V);

r14=-kf(14)*(b(7)./V)+kb(14)*(b(3)./V)*(b(5)./V);

r15=-kf(15)*(b(15)./V)+kb(15)*(b(5)./V)*(b(2)./V);

r16=-kf(16)*(b(9)./V)+kb(16)*(b(4)./V)*(b(3)./V);

r17=-kf(17)*(b(9)./V)+kb(17)*(b(5)./V)*(b(7)./V);

r18=-kf(18)*(b(10)./V)+kb(18)*(b(4)./V)*(b(2)./V);

r19=-kf(19)*(b(10)./V)+kb(19)*(b(5)./V)*(b(15)./V);

r20=-kf(20)*(b(16)./V)+kb(20)*(b(4)./V)*(b(7)./V);

r21=-kf(21)*(b(16)./V)+kb(21)*(b(6)./V)*(b(3)./V);

r22=-kf(22)*(b(16)./V)+kb(22)*(b(9)./V)*(b(5)./V);

r23=-2*kf(23)*(b(3)./V)*(b(3)./V)+kb(23)*(b(13)./V);

r24=-2*kf(24)*(b(2)./V)*(b(2)./V)+kb(24)*(b(14)./V);

%b=v*(r1+r4+r5+r6+r7+r8+r9+r10+r11);

a=V*(-kf(1)*(b(1)./V)+kb(1)*(b(2)./V).*(b(3)./V)-kf(4).*(b(1)./V).*(b(5)./V)+kb(4).*(b(7)./V).*(b(2)./V)-kf(5).*(b(5)./V).*(b(1)./V)+kb(5).*(b(8)./V)-kf(6).*(b(1)./V).*(b(4)./V)+kb(6).*(b(9)./V).*(b(2)./V)-kf(7).*(b(1)./V).*(b(4)./V)+kb(7).*(b(10)./V).*(b(3)./V)-kf(8).*(b(1)./V).*(b(4)./V)+kb(8).*(b(11)./V)-kf(9).*(b(1)./V).*(b(6)./V)+kb(9).*(b(12)./V)-kf(10).*(b(1)./V).*(b(3)./V)+kb(10).*(b(2)./V).*(b(13)./V)-kf(11).*(b(1)./V).*(b(2)./V)+kb(11).*(b(14)./V).*(b(3)./V));

%c=v.*(-r1-r4-r6-r10+r11-r13-r15-r18+2.*r24);

c=V.*((-1).*(-kf(1).*(b(1)./V)+kb(1).*(b(2)./V).*(b(3)./V)-kf(4).*(b(1)./V).*(b(5)./V)+kb(4).*(b(7)./V).*(b(2)./V)-kf(6).*(b(1)./V).*(b(4)./V)+kb(6).*(b(9)./V).*(b(2)./V)-kf(10).*(b(1)./V).*(b(3)./V)+kb(10).*(b(2)./V).*(b(13)./V)-kf(13).*(b(8)./V)+kb(13).*(b(7)./V).*(b(2)./V)-kf(15).*(b(15)./V)+kb(15).*(b(5)./V).*(b(2)./V)-kf(18).*(b(10)./V)+kb(18).*(b(4)./V).*(b(2)./V))+-kf(11).*(b(1)./V).*(b(2)./V)+kb(11).*(b(14)./V).*(b(3)./V)+(2).*(-2.*kf(24).*(b(2)./V).*(b(2)./V)+kb(24).*(b(14)./V)));

%d=v.*(-r1-r7+r10-r11-r12-r14-r16-r21+2.*r23);

d=V.*((-1).*(-kf(1).*(b(1)./V)+kb(1).*(b(2)./V).*(b(3)./V))+(-1).*(-kf(7).*(b(1)./V).*(b(4)./V)+kb(7).*(b(10)./V).*(b(3)./V))-kf(10).*(b(1)./V).*(b(3)./V)+kb(10).*(b(2)./V).*(b(13)./V)+(-1).*(-kf(11).*(b(1)./V).*(b(2)./V)+kb(11).*(b(14)./V).*(b(3)./V)-kf(12).*(b(8)./V)+kb(12).*(b(15)./V).*(b(3)./V)-kf(14).*(b(7)./V)+kb(14).*(b(3)./V).*(b(5)./V)-kf(16).*(b(9)./V)+kb(16).*(b(4)./V).*(b(3)./V)-kf(21).*(b(16)./V)+kb(21).*(b(6)./V).*(b(3)./V))+2.*(-2.*kf(23).*(b(3)./V).*(b(3)./V)+kb(23).*(b(13)./V)));


%e=v.*(r2-r3+r6+r7+r8-r16-r18-r20);  

e=V.*(-kf(2).*(b(4)./V)+2.*kb(2).*(b(5)./V).*(b(5)./V)+(-1).*(-kf(3).*(b(6)./V)+kb(3).*(b(4)./V).*(b(5)./V))-kf(6).*(b(1)./V).*(b(4)./V)+kb(6).*(b(9)./V).*(b(2)./V)-kf(7).*(b(1)./V).*(b(4)./V)+kb(7).*(b(10)./V).*(b(3)./V)-kf(8).*(b(1)./V).*(b(4)./V)+kb(8).*(b(11)./V)+(-1).*(-kf(16).*(b(9)./V)+kb(16).*(b(4)./V).*(b(3)./V)-kf(18).*(b(10)./V)+kb(18).*(b(4)./V).*(b(2)./V)-kf(20).*(b(16)./V)+kb(20).*(b(4)./V).*(b(7)./V)));

%f=v.*(-2.*r2-r3+r4+r5-r14-r15-r17-r19-r22);

f=V.*((-2).*(-kf(2).*(b(4)./V)+2.*kb(2).*(b(5)./V).*(b(5)./V))+(-1).*(-kf(3).*(b(6)./V)+kb(3).*(b(4)./V).*(b(5)./V))-kf(4).*(b(1)./V).*(b(5)./V)+kb(4).*(b(7)./V).*(b(2)./V)-kf(5).*(b(5)./V).*(b(1)./V)+kb(5).*(b(8)./V)+(-1).*(-kf(14).*(b(7)./V)+kb(14).*(b(3)./V).*(b(5)./V)-kf(15).*(b(15)./V)+kb(15).*(b(5)./V).*(b(2)./V)-kf(17).*(b(9)./V)+kb(17).*(b(5)./V).*(b(7)./V)-kf(19).*(b(10)./V)+kb(19).*(b(5)./V).*(b(15)./V)-kf(22).*(b(16)./V)+kb(22).*(b(9)./V).*(b(5)./V)));

%g=v.*(r3+r9-r21);

g=V.*(-kf(3).*(b(6)./V)+kb(3).*(b(4)./V).*(b(5)./V)-kf(9).*(b(1)./V).*(b(6)./V)+kb(9).*(b(12)./V)+(-1).*(-kf(21).*(b(16)./V)+kb(21).*(b(6)./V).*(b(3)./V)));

%h=v.*(-r4-r13+r14-r17-r20);

h=V.*((-1).*(-kf(4).*(b(1)./V).*(b(5)./V)+kb(4).*(b(7)./V).*(b(2)./V)-kf(13).*(b(8)./V)+kb(13).*(b(7)./V).*(b(2)./V)-kf(17).*(b(9)./V)+kb(17).*(b(5)./V).*(b(7)./V)-kf(20).*(b(16)./V)+kb(20).*(b(4)./V).*(b(7)./V))-kf(14).*(b(7)./V)+kb(14).*(b(3)./V).*(b(5)./V));

%i=v.*(-r5+r12+r13);

i=V.*(-kf(12).*(b(8)./V)+kb(12).*(b(15)./V).*(b(3)./V)-kf(13).*(b(8)./V)+kb(13).*(b(7)./V).*(b(2)./V)+(-1).*(-kf(5).*(b(5)./V).*(b(1)./V)+kb(5).*(b(8)./V)));

%j=v.*(-r6+r16+r17-r22);

j=V.*(-kf(16).*(b(9)./V)+kb(16).*(b(4)./V).*(b(3)./V)-kf(17).*(b(9)./V)+kb(17).*(b(5)./V).*(b(7)./V)+(-1).*(-kf(6).*(b(1)./V).*(b(4)./V)+kb(6).*(b(9)./V).*(b(2)./V)-kf(22).*(b(16)./V)+kb(22).*(b(9)./V).*(b(5)./V)));

%k=v.*(-r7+r18+r19);

k=V.*(-kf(18).*(b(10)./V)+kb(18).*(b(4)./V).*(b(2)./V)-kf(19).*(b(10)./V)+kb(19).*(b(5)./V).*(b(15)./V)+(-1).*(-kf(7).*(b(1)./V).*(b(4)./V)+kb(7).*(b(10)./V).*(b(3)./V)));

%l=v.*(-r8);

l=V.*((-1).*(-kf(8).*(b(1)./V).*(b(4)./V)+kb(8).*(b(11)./V)));

%m=v.*(-r9);

m=V.*((-1).*(-kf(9).*(b(1)./V).*(b(6)./V)+kb(9).*(b(12)./V)));

%n=v.*(-r10-r23);

n=V.*((-1).*(-kf(10).*(b(1)./V).*(b(3)./V)+kb(10).*(b(2)./V).*(b(13)./V)-2.*kf(23).*(b(3)./V).*(b(3)./V)+kb(23).*(b(13)./V)));

%o=v.*(-r11-r24);

o=V.*((-1).*(-kf(11).*(b(1)./V).*(b(2)./V)+kb(11).*(b(14)./V).*(b(3)./V)-2.*kf(24).*(b(2)./V).*(b(2)./V)+kb(24).*(b(14)./V)));

%p=v.*(-r12+r15-r19);

p=V.*((-1).*(-kf(12).*(b(8)./V)+kb(12).*(b(15)./V).*(b(3)./V)-kf(19).*(b(10)./V)+kb(19).*(b(5)./V).*(b(15)./V))-kf(15).*(b(15)./V)+kb(15).*(b(5)./V).*(b(2)./V));

%q=v.*(r20+r21+r22);

q=V.*(-kf(20).*(b(16)./V)+kb(20).*(b(4)./V).*(b(7)./V)-kf(21).*(b(16)./V)+kb(21).*(b(6)./V).*(b(3)./V)-kf(22).*(b(16)./V)+kb(22).*(b(9)./V).*(b(5)./V));

x1 = v .* (-kfn(1) * (Y(:, 1) ./ v) + kbn(1) * (Y(:, 2) ./ v) .* (Y(:, 3) ./ v));
x4 = v .* (-kfn(4) * (Y(:, 1) ./ v) .* (Y(:, 5) ./ v) + kbn(4) * (Y(:, 7) ./ v) .* (Y(:, 2) ./ v));
x5 = v .* (-kfn(5) * (Y(:, 5) ./ v) .* (Y(:, 1) ./ v) + kbn(5) * (Y(:, 8) ./ v));
x6 = v .* (-kfn(6) * (Y(:, 1) ./ v) .* (Y(:, 4) ./ v) + kbn(6) * (Y(:, 9) ./ v) .* (Y(:, 2) ./ v));
x7 = v .* (-kfn(7) * (Y(:, 1) ./ v) .* (Y(:, 4) ./ v) + kbn(7) * (Y(:, 10) ./ v) .* (Y(:, 3) ./ v));
x8 = v .* (-kfn(8) * (Y(:, 1) ./ v) .* (Y(:, 4) ./ v) + kbn(8) * (Y(:, 11) ./ v));
x9 = v .* (-kfn(9) * (Y(:, 1) ./ v) .* (Y(:, 6) ./ v) + kbn(9) * (Y(:, 12) ./ v));
x10 = v .* (-kfn(10) * (Y(:, 1) ./ v) .* (Y(:, 3) ./ v) + kbn(10) * (Y(:, 2) ./ v) .* (Y(:, 13) ./ v));
x11 = v .* (-kfn(11) * (Y(:, 1) ./ v) .* (Y(:, 2) ./ v) + kbn(11) * (Y(:, 14) ./ v) .* (Y(:, 3) ./ v));

% Degree of rate control
x = [x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

dydt=[a;c;d;e;f;g;h;i;j;k;l;m;n;o;p;q];
end
